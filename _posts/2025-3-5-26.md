---
title: ä¸€äº›åŒ–å­¦åº“çš„ä»å¤´ç¼–è¯‘
date: 2025-3-5 12:00:00 +0800
categories: [Quantum Chemistry,note]
tags: [note,rdkit,openbabel]   
---

å› ä¸ºpythonå¯åŠ¨æœ‰ç‚¹æ…¢ï¼Œæœ‰äº›éå¸¸å¸¸ç”¨åˆç®€å•çš„å°å·¥å…·ç¬”è€…å®åœ¨æƒ³è½¬æˆC++çš„ï¼Œäºæ˜¯ä¸å¾—ä¸å­¦ä¹ å¦‚ä½•ç¼–è¯‘è¿™äº›åº“ã€‚

## OpenBabel
å®˜ç½‘ç»™å‡ºçš„ä¸‹è½½é“¾æ¥ç›´é€š2.4.0æºç ï¼Œä»¤äººå¿ä¿Šä¸ç¦ã€‚çœŸæ­£çš„æºç è¦åœ¨[github](https://github.com/openbabel/openbabel/releases)ä¸Šæåˆ°ï¼Œç›®å‰çš„å‘è¡Œç‰ˆæ˜¯3.1.1ï¼Œä¸‹è½½ä¸‹æ¥ä¹‹åè§£å‹ï¼š
```
tar -jxvf openbabel-3.1.1-source.tar.bz2
```
åˆ›å»ºbuildæ–‡ä»¶å¤¹ï¼Œè¿è¡Œcmakeï¼š
```
cd openbabel-3.1.1
mkdir build
cd build
cmake ..
```
æç¤ºcmakeç‰ˆæœ¬è¿‡ä½ï¼Œå¥½åœ¨æœåŠ¡å™¨ä¸Šæœ‰ç°æˆçš„cmake3.23(çŠ¹è®°å½“æ—¶ä¸çŸ¥é“æœåŠ¡å™¨æœ‰è¿™äº›é«˜ç‰ˆæœ¬çš„è½¯ä»¶ï¼Œæ‰‹æ“cmakeçš„ç»å†~~ï¼Œç„¶åå‘ç°ç¼–è¯‘cmakeæ—¶æŠ¥é”™gccç‰ˆæœ¬è¿‡ä½ğŸ‘½~~)

åˆ‡æ¢3.23åcmakeæˆåŠŸäº†ï¼Œå¼€å§‹ç¼–è¯‘ã€‚
```
make -j4
```
å°‘æœ‰çš„ä¸€éè¿‡ï¼Œå¾ˆé¡ºåˆ©ï¼Œå°±æ˜¯æ—¶é—´æœ‰ç‚¹ä¹…ï¼ŒèŠ±äº†å¾—æœ‰20åˆ†é’Ÿ
```
[100%] Building CXX object test/CMakeFiles/test_runner.dir/unitcell.cpp.o
[100%] Building CXX object test/CMakeFiles/test_runner.dir/cmlreadfile.cpp.o
[100%] Building CXX object test/CMakeFiles/test_runner.dir/obtest.cpp.o
[100%] Linking CXX executable ../bin/test_runner
[100%] Built target test_runner
(obabel) [gaus@login02 build]$
```
å®‰è£…äºŒè¿›åˆ¶æ–‡ä»¶ï¼š
```
make install
```
é™¤äº†æ²¡æƒé™å†™å…¥/usr/localå¤±è´¥ä»¥å¤–ï¼Œå®‰è£…æ˜¯æˆåŠŸçš„
```
[ 87%] Built target obspectrophore
Consolidate compiler generated dependencies of target test_runner
[ 99%] Built target test_runner
Consolidate compiler generated dependencies of target test_inchiwrite
[100%] Built target test_inchiwrite
Consolidate compiler generated dependencies of target roundtrip
[100%] Built target roundtrip
Install the project...
-- Install configuration: "Release"
CMake Error at cmake_install.cmake:46 (file):
  file cannot create directory: /usr/local/include/openbabel3/openbabel.
  Maybe need administrative privileges.


make: *** [Makefile:110: install] Error 1
(obabel) [gaus@login02 build]$
```
éªŒè¯ï¼š
```
(obabel) [gaus@login02 build]$ ./bin/obabel --version
No input file or format spec or possibly a misplaced option.
Most options must come after the input files. (-i -o -O -m can be anywhwere.)

Open Babel 3.1.0 -- Mar  5 2025 -- 18:43:41
Usage:
obabel [-i<input-type>] <infilename> [-o<output-type>] -O<outfilename> [Options]
Try  -H option for more information.
(obabel) [gaus@login02 build]$
```

## RDkit
RDkitçš„å¼•å¯¼ç›¸å¯¹openbabelæ¥è¯´å°±å¾ˆé½å…¨äº†ï¼Œå‡†å¤‡ç¯å¢ƒï¼š
```
conda create -n rdkitmake python=3.9 -y
conda activate rdkitmake
conda install -y cmake cairo pillow eigen pkg-config
conda install -y boost-cpp boost py-boost
conda install -y gxx_linux-64
```

æ³¨æ„``conda install -y gxx_linux-64``è¿™é‡Œæœ‰å‘ï¼Œè§ä¸‹æ–¹æŠ¥é”™ä¸è§£å†³ã€‚

ç¼–è¯‘ï¼š
```
git clone https://github.com/rdkit/rdkit.git
cd rdkit
mkdir build && cd build
cmake -DPy_ENABLE_SHARED=1 \
  -DRDK_INSTALL_INTREE=ON \
  -DRDK_INSTALL_STATIC_LIBS=ON \
  -DRDK_BUILD_CPP_TESTS=ON \
  -DPYTHON_NUMPY_INCLUDE_PATH="$(python -c 'import numpy ; print(numpy.get_include())')" \
  -DBOOST_ROOT="$CONDA_PREFIX" \
  ..

make -j16
make install
```
æµ‹è¯•
```
RDBASE=$PWD/.. PYTHONPATH=$RDBASE:$PYTHONPATH LD_LIBRARY_PATH=$RDBASE/lib:$LD_LIBRARY_PATH ctest
```

### æŠ¥é”™ä¸è§£å†³

#### boostä¸gccç‰ˆæœ¬ä¸å…¼å®¹
ç°è±¡ï¼š
```
In file included from /root/miniconda/envs/rdkitmake/include/boost/cstdfloat.hpp:22,
                 from /root/miniconda/envs/rdkitmake/include/boost/multiprecision/detail/float128_functions.hpp:15,
                ...

                 from /home/bane/scripts/Libs/rdkit/Code/GraphMol/ChemReactions/Enumerate/Enumerate.cpp:43:
/root/miniconda/envs/rdkitmake/include/boost/math/cstdfloat/cstdfloat_limits.hpp:46:13: error: redefinition of 'class std::numeric_limits<__float128>'
   46 |       class numeric_limits<boost::math::cstdfloat::detail::float_internal128_t>
      |             ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
In file included from /root/miniconda/envs/rdkitmake/include/boost/limits.hpp:19,
                ...
                
                 from /home/bane/scripts/Libs/rdkit/Code/GraphMol/ChemReactions/Enumerate/Enumerate.cpp:33:
/root/miniconda/envs/rdkitmake/lib/gcc/x86_64-conda-linux-gnu/14.2.0/include/c++/limits:2089:12: note: previous definition of 'class std::numeric_limits<__float128>'
 2089 |     struct numeric_limits<__float128>
      |            ^~~~~~~~~~~~~~~~~~~~~~~~~~
make[2]: *** [Code/GraphMol/ChemReactions/CMakeFiles/ChemReactions_static.dir/build.make:272: Code/GraphMol/ChemReactions/CMakeFiles/ChemReactions_static.dir/Enumerate/Enumerate.cpp.o] Error 1
make[1]: *** [CMakeFiles/Makefile2:8944: Code/GraphMol/ChemReactions/CMakeFiles/ChemReactions_static.dir/all] Error 2
make[1]: *** Waiting for unfinished jobs....
```
ç‰ˆæœ¬ï¼š
```
boost                     1.82.0           py39h9ff65d1_0    conda-forge
boost-cpp                 1.82.0               hdb19cb5_2  
py-boost                  1.82.0           py39h3c18c91_2

gcc_linux-64              14.2.0               h5910c8f_8    conda-forge
gxx_linux-64              14.2.0               h9423afd_8    conda-forge
```

è§£å†³åŠæ³•ï¼šé™çº§gccåˆ°<10çš„ç‰ˆæœ¬

```
conda install -y gxx_linux-64=9.5.0
```
#### æ²¡æœ‰å®‰è£…pytest
ç°è±¡ï¼š
```
240/242 Test #240: pyFeatures .............................   Passed    0.15 sec
        Start 241: pythonProjectTests
241/242 Test #241: pythonProjectTests .....................***Failed    0.02 sec
        Start 242: pythonSourceTests
242/242 Test #242: pythonSourceTests ......................***Failed    0.01 sec

99% tests passed, 2 tests failed out of 242

Total Test time (real) = 254.77 sec

The following tests FAILED:
        241 - pythonProjectTests (Failed)
        242 - pythonSourceTests (Failed)
Errors while running CTest
Output from these tests are in: /home/bane/scripts/Libs/rdkit/build/Testing/Temporary/LastTest.log
Use "--rerun-failed --output-on-failure" to re-run the failed cases verbosely.
(rdkitmake) root@wcy:/home/bane/scripts/Libs/rdkit/build#
```

è§£å†³ï¼šå¦‚æœä¸ä¿®æ”¹æºç å°±ä¸ç”¨ç®¡è¿™ä¿©