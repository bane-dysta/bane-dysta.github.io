---
title: 自旋轨道耦合矩阵元的计算方法
date: 2024-11-9 12:00:00 +0800
categories: [Calculation, Quantum Chemistry]
tags: [SOC]     
math: true
---
自旋轨道耦合(Spin-Orbit Coupling, SOC)常简称旋轨耦合，是一个量子力学概念，描述了粒子的自旋磁矩与其轨道角动量之间相互作用。它的数学表示为：

$$
H_{SOC} = \lambda \mathbf{L} \cdot \mathbf{S}
$$
其中：$H_{SOC}$是自旋轨道耦合的哈密顿量，$\lambda$ 是耦合常数，$\mathbf{L}$ 是轨道角动量算符，$\mathbf{S}$ 是自旋角动量算符。当某单重态$S_n$与某三重态$T_n$之间存在显著的旋轨耦合时，自旋角动量会偏离期望值，引起两个态的混合，对应波函数$\Psi_S$与$\Psi_T$之间的耦合强度由旋轨耦合矩阵元(又称旋轨耦合常数，SOCME)给出：

$$
\langle \Psi_S |H_{SOC}| \Psi_T \rangle
$$
SOCME是可以使用量子化学方法计算得到的。有了SOCME，再加上单重态与三重态的能差$\Delta E_{ST}$，就可以计算ISC的速率了。

总之，本文记录一下SOCME的不同计算方法，以备不时之需。
## 1. PySOC
PySOC计算旋轨耦合常数基于Gaussian 09，需要先做一个TD(50-50,nstate=8)计算并保留swf文件，再用PySOC进行处理。由于笔者的服务器太老，无法兼容较新的glbic库，不能运行PySOC，因此跳过该法。

参考：[使用Gaussian+PySOC在TDDFT下计算旋轨耦合矩阵元](http://sobereva.com/411)

## 2. ORCA (Recommend)
ORCA 4.1开始支持计算TD-DFT级别下闭壳层体系的旋轨耦合常数，操作比较简单。首先，对体系进行结构优化，这部分可以在Gaussian中完成。随后，将Gaussian输出文件转换为xyz格式：
~~~
obabel coumarin.log -O coumarin.xyz
~~~
创建一个soc.inp，编辑计算输入文件：
~~~
! WB97X-D3 def2-SVP miniprint tightSCF
%pal
nprocs 32
end
%maxcore 3000
%tddft
nroots 5
dosoc true
tda false
printlevel 3
end

* xyzfile 0 1 coumarin.xyz
//要留空行
~~~
将该文件提交计算，在输出中找到这部分：
~~~
                      CALCULATED SOCME BETWEEN TRIPLETS AND SINGLETS                  
      --------------------------------------------------------------------------------
           Root                          <T|HSO|S>  (Re, Im) cm-1                     
         T      S           MS= 0                  -1                    +1           
      --------------------------------------------------------------------------------
         1      0    (   0.00 ,    0.07)    (   0.06 ,   -0.01)    (   0.06 ,    0.01)
         1      1    (   0.00 ,   -0.00)    (   0.04 ,    0.00)    (   0.04 ,   -0.00)
         1      2    (   0.00 ,   -0.90)    (   6.95 ,    3.01)    (   6.95 ,   -3.01)
         1      3    (   0.00 ,   -0.03)    (   0.16 ,    0.00)    (   0.16 ,   -0.00)
         1      4    (   0.00 ,   -0.06)    (   0.09 ,   -0.06)    (   0.09 ,    0.06)
         1      5    (   0.00 ,    1.49)    (  -8.36 ,    7.13)    (  -8.36 ,   -7.13)
         2      0    (   0.00 ,   -0.07)    (  -0.01 ,   -0.08)    (  -0.01 ,    0.08)
         2      1    (   0.00 ,   -0.00)    (  -0.02 ,    0.01)    (  -0.02 ,   -0.01)
         2      2    (   0.00 ,    0.76)    (  -5.88 ,   -2.81)    (  -5.88 ,    2.81)
         2      3    (   0.00 ,   -0.02)    (  -0.01 ,    0.10)    (  -0.01 ,   -0.10)
         2      4    (   0.00 ,    0.01)    (  -0.04 ,    0.11)    (  -0.04 ,   -0.11)
         ...
~~~
这里每一行的输出是$S_n$态与$T_n$态的三个不同自旋磁量子数的子态的旋轨耦合矩阵元的模。简单来讲，想得到SOCME值，就把对应行的六个数值求平方加和再开根号。
## 3. Gaussian
Gaussian支持CASSCF级别的旋轨耦合计算，待学习。





